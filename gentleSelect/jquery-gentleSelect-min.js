(function(a){function d(b,d){if(c(d.columns)&&c(d.rows)){a.error("gentleSelect: You cannot supply both 'rows' and 'columns'");return true}if(c(d.columns)&&!c(d.itemWidth)){a.error("gentleSelect: itemWidth must be supplied if 'columns' is specified");return true}if(c(d.rows)&&!c(d.itemWidth)){a.error("gentleSelect: itemWidth must be supplied if 'rows' is specified");return true}if(!c(d.openSpeed)||typeof d.openSpeed!="number"&&typeof d.openSpeed=="string"&&d.openSpeed!="slow"&&d.openSpeed!="fast"){a.error('gentleSelect: openSpeed must be an integer or "slow" or "fast"');return true}if(!c(d.closeSpeed)||typeof d.closeSpeed!="number"&&typeof d.closeSpeed=="string"&&d.closeSpeed!="slow"&&d.closeSpeed!="fast"){a.error('gentleSelect: closeSpeed must be an integer or "slow" or "fast"');return true}if(!c(d.openEffect)||d.openEffect!="fade"&&d.openEffect!="slide"){a.error("gentleSelect: openEffect must be either 'fade' or 'slide'!");return true}if(!c(d.closeEffect)||d.closeEffect!="fade"&&d.closeEffect!="slide"){a.error("gentleSelect: closeEffect must be either 'fade' or 'slide'!");return true}if(!c(d.hideOnMouseOut)||typeof d.hideOnMouseOut!="boolean"){a.error('gentleSelect: hideOnMouseOut must be supplied and either "true" or "false"!');return true}return false}function c(a){if(typeof a=="undefined"){return false}else{return true}}var b={minWidth:100,itemWidth:undefined,columns:undefined,rows:undefined,title:undefined,prompt:"Make A Selection",maxDisplay:4,openSpeed:400,closeSpeed:400,openEffect:"slide",closeEffect:"slide",hideOnMouseOut:true};var e={init:function(e){var g=a.extend({},b,e);if(d(this,g)){return this}this.hide();var h=this.find(":selected");if(h.length>g.maxDisplay)var i="Multiple Selections";else if(h.length<1)var i=g.prompt;else var i=h.map(function(){return a(this).text()}).get().join(", ");var j=a("<span class='gentleselect-label'>"+i+"</span>").insertBefore(this).bind("mouseenter.gentleselect",f.labelHoverIn).bind("mouseleave.gentleselect",f.labelHoverOut).bind("click.gentleselect",f.labelClick).data("root",this);this.data("label",j).data("options",g);var k=a("<ul></ul>");this.find("option").each(function(){var b=a("<li>"+a(this).text()+"</li>").data("value",a(this).attr("value")).data("name",a(this).text()).appendTo(k);if(a(this).attr("selected")){b.addClass("selected")}});var l=a("<div class='gentleselect-dialog'></div>").append(k).insertAfter(j).bind("mouseleave.gentleselect",f.dialogHoverOut).data("label",j).data("root",this);this.data("dialog",l);if(this.attr("multiple")){l.data("multiple",true);l.bind("click.gentleselect",f.multiselectDialogClick)}else{l.data("multiple",false);l.bind("click.gentleselect",f.dialogClick)}if(c(g.columns)||c(g.rows)){k.css("float","left").find("li").width(g.itemWidth).css("float","left");var m=k.find("li:first");var n=g.itemWidth+parseInt(m.css("padding-left"))+parseInt(m.css("padding-right"));var o=k.find("li").length;if(c(g.columns)){var p=parseInt(g.columns);var q=Math.ceil(o/p)}else{var q=parseInt(g.rows);var p=Math.ceil(o/q)}l.width(n*p);for(var r=0;r<q*p-o;r++){a("<li style='float:left' class='gentleselect-dummy'><span> </span></li>").appendTo(k)}var s=[];var t=0;k.find("li").each(function(){if(t<q){s[t]=a(this)}else{var b=t%q;a(this).insertAfter(s[b]);s[b]=a(this)}t++})}else if(typeof g.minWidth=="number"){l.css("min-width",g.minWidth)}if(c(g.title)){a("<div class='gentleselect-title'>"+g.title+"</div>").prependTo(l)}a(document).bind("keyup.gentleselect",f.keyUp);return this},update:function(){var b=this;var c=this.val();this.data("dialog").find("li").each(function(){if(a(this).data("value")==c){a(this).addClass("selected");b.data("label").text(a(this).data("name"))}else{a(this).removeClass("selected")}});return this}};var f={labelHoverIn:function(){a(this).addClass("gentleselect-label-highlight")},labelHoverOut:function(){a(this).removeClass("gentleselect-label-highlight")},labelClick:function(){var b=a(this).position();var c=a(this).data("root");var d=c.data("options");var e=c.data("dialog").css("top",b.top+c.height()).css("left",b.left+1);if(d.openEffect=="fade"){e.fadeIn(d.openSpeed)}else{e.slideDown(d.openSpeed)}},dialogHoverOut:function(){if(a(this).data("root").data("options").hideOnMouseOut){a(this).hide()}},dialogClick:function(b){var c=a(b.target);var d=a(this).data("root").data("options");if(d.closeEffect=="fade"){a(this).fadeOut(d.closeSpeed)}else{a(this).slideUp(d.closeSpeed)}if(c.is("li")&&!c.hasClass("gentleselect-dummy")){var e=c.data("value");var f=c.data("name");var g=a(this).data("label").text(f);a(this).find("li.selected").removeClass("selected");c.addClass("selected");var h=a(this).data("root").val(e).trigger("change")}},multiselectDialogClick:function(b){var c=a(b.target);var d=a(this).data("root").data("options");if(c.is("li")&&!c.hasClass("gentleselect-dummy")){var e=c.data("value");var f=c.data("name");var g=a(this).data("label");if(c.hasClass("selected")){c.removeClass("selected")}else{c.addClass("selected")}var h=a(this).find("li.selected").map(function(){return a(this).data("value")}).get();var i=a(this).find("li.selected").map(function(){return a(this).text()}).get().sort().join(", ");if(h.length>d.maxDisplay)g.text("Multiple Selections");else if(h.length<1)g.text(d.prompt);else g.text(i);var j=a(this).data("root").val(h).trigger("change")}},keyUp:function(b){if(b.keyCode==27){a(".gentleselect-dialog").hide()}}};a.fn.gentleSelect=function(b){if(e[b]){return e[b].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof b==="object"||!b){return e.init.apply(this,arguments)}else{a.error("Method "+b+" does not exist on jQuery.gentleSelect")}}})(jQuery)