(function(e){function n(e){if(typeof e=="undefined"){return false}else{return true}}function r(t,r){if(n(r.columns)&&n(r.rows)){e.error("gentleSelect: You cannot supply both 'rows' and 'columns'");return true}if(n(r.columns)&&!n(r.itemWidth)){e.error("gentleSelect: itemWidth must be supplied if 'columns' is specified");return true}if(n(r.rows)&&!n(r.itemWidth)){e.error("gentleSelect: itemWidth must be supplied if 'rows' is specified");return true}if(!n(r.openSpeed)||typeof r.openSpeed!="number"&&typeof r.openSpeed=="string"&&r.openSpeed!="slow"&&r.openSpeed!="fast"){e.error('gentleSelect: openSpeed must be an integer or "slow" or "fast"');return true}if(!n(r.closeSpeed)||typeof r.closeSpeed!="number"&&typeof r.closeSpeed=="string"&&r.closeSpeed!="slow"&&r.closeSpeed!="fast"){e.error('gentleSelect: closeSpeed must be an integer or "slow" or "fast"');return true}if(!n(r.openEffect)||r.openEffect!="fade"&&r.openEffect!="slide"){e.error("gentleSelect: openEffect must be either 'fade' or 'slide'!");return true}if(!n(r.closeEffect)||r.closeEffect!="fade"&&r.closeEffect!="slide"){e.error("gentleSelect: closeEffect must be either 'fade' or 'slide'!");return true}if(!n(r.hideOnMouseOut)||typeof r.hideOnMouseOut!="boolean"){e.error('gentleSelect: hideOnMouseOut must be supplied and either "true" or "false"!');return true}return false}function i(e,t){if(e.attr("multiple")){t.hideOnMouseOut=true}}function s(t,n){if(t.length<1){return n.prompt}if(n.maxDisplay!=0&&t.length>n.maxDisplay){var r=t.slice(0,n.maxDisplay).map(function(){return e(this).text()});r.push("...")}else{var r=t.map(function(){return e(this).text()})}return r.get().join(", ")}function o(t,r,i){e.get(r,i,function(r){t.empty();jQuery.each(r,function(n,r){var i=e("<option>"+r.label+"</option>").attr("value",r.value).appendTo(t);if(r.selected){i.attr("selected",true)}});var i=t.data("label");if(n(i)){i.remove()}var s=t.data("dialog");if(n(s)){s.remove()}u(t)},"json")}function u(t){var r=t.data("options");t.hide();label_text=s(t.find(":selected"),r);var i=e("<span class='gentleselect-label'>"+label_text+"</span>").insertBefore(t).bind("mouseenter.gentleselect",f.labelHoverIn).bind("mouseleave.gentleselect",f.labelHoverOut).bind("click.gentleselect",f.labelClick).data("root",t);t.data("label",i);var o=e("<ul></ul>");t.find("option").each(function(){var t=e("<li>"+e(this).text()+"</li>").data("value",e(this).attr("value")).data("name",e(this).text()).appendTo(o);if(e(this).attr("selected")){t.addClass("selected")}});var u=e("<div class='gentleselect-dialog'></div>").append(o).insertAfter(i).bind("click.gentleselect",f.dialogClick).bind("mouseleave.gentleselect",f.dialogHoverOut).data("label",i).data("root",t);t.data("dialog",u);if(n(r.columns)||n(r.rows)){o.css("float","left").find("li").width(r.itemWidth).css("float","left");var a=o.find("li:first");var l=r.itemWidth+parseInt(a.css("padding-left"))+parseInt(a.css("padding-right"));var c=o.find("li").length;if(n(r.columns)){var h=parseInt(r.columns);var p=Math.ceil(c/h)}else{var p=parseInt(r.rows);var h=Math.ceil(c/p)}u.width(l*h);for(var d=0;d<p*h-c;d++){e("<li style='float:left' class='gentleselect-dummy'><span>&nbsp;</span></li>").appendTo(o)}var v=[];var m=0;o.find("li").each(function(){if(m<p){v[m]=e(this)}else{var t=m%p;e(this).insertAfter(v[t]);v[t]=e(this)}m++})}else if(typeof r.minWidth=="number"){u.css("min-width",r.minWidth)}if(n(r.title)){e("<div class='gentleselect-title'>"+r.title+"</div>").prependTo(u)}e(document).bind("keyup.gentleselect",f.keyUp)}var t={minWidth:100,itemWidth:undefined,columns:undefined,rows:undefined,title:undefined,prompt:"Make A Selection",maxDisplay:0,openSpeed:400,closeSpeed:400,openEffect:"slide",closeEffect:"slide",hideOnMouseOut:true,url:undefined,urlData:{}};var a={init:function(s){var a=e.extend({},t,s);if(r(this,a)){return this}i(this,a);this.data("options",a);u(this);if(n(a.url)){o(this,a.url,a.urlData)}return this},refresh:function(t){if(!n(this.data("options").url)){e.error("gentleSelect: 'url' must be supplied to use 'refresh'");return this}if(!n(t)){t=this.data("options").urlData}o(this,this.data("options").url,t);return this},update:function(){var t=this.data("options");var n=this.attr("multiple")?this.val():[this.val()];e("li",this.data("dialog")).each(function(){var t=e(this);var r=e.inArray(t.data("value"),n)!=-1;t.toggleClass("selected",r)});var r=s(this.find(":selected"),t);this.data("label").text(r);return this}};var f={labelHoverIn:function(){e(this).addClass("gentleselect-label-highlight")},labelHoverOut:function(){e(this).removeClass("gentleselect-label-highlight")},labelClick:function(){var t=e(this);var n=t.position();var r=t.data("root");var i=r.data("options");var s=r.data("dialog").css("top",n.top+t.height()).css("left",n.left+1);if(i.openEffect=="fade"){s.fadeIn(i.openSpeed)}else{s.slideDown(i.openSpeed)}},dialogHoverOut:function(){var t=e(this);if(t.data("root").data("options").hideOnMouseOut){t.hide()}},dialogClick:function(t){var n=e(t.target);var r=e(this);var i=r.data("root");var o=i.data("options");if(!i.attr("multiple")){if(o.closeEffect=="fade"){r.fadeOut(o.closeSpeed)}else{r.slideUp(o.closeSpeed)}}if(n.is("li")&&!n.hasClass("gentleselect-dummy")){var u=n.data("value");var a=n.data("name");var f=r.data("label");if(r.data("root").attr("multiple")){n.toggleClass("selected");var l=r.find("li.selected");f.text(s(l,o));var c=l.map(function(){return e(this).data("value")});i.val(c.get()).trigger("change")}else{r.find("li.selected").removeClass("selected");n.addClass("selected");f.text(n.data("name"));i.val(u).trigger("change")}}},keyUp:function(t){if(t.keyCode==27){e(".gentleselect-dialog").hide()}}};e.fn.gentleSelect=function(t){if(a[t]){return a[t].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof t==="object"||!t){return a.init.apply(this,arguments)}else{e.error("Method "+t+" does not exist on jQuery.gentleSelect")}}})(jQuery);